diabetes <- read.csv("diabetes.csv")
library(monomvn) ## install.packages("monomvn")
install.packages("monomvn")
diabetes_design <- model.matrix(prog ~ . - 1, data = diabetes)
diabetes_design_std <- scale(diabetes_design, center = TRUE, scale = TRUE)
diabetes_response <- diabetes$prog - mean(diabetes$prog)
diabetes_blasso <- blasso(X = diabetes_design_std, y = diabetes_response, T = 500, thin = 200)
library(monomvn) ## install.packages("monomvn")
diabetes_design <- model.matrix(prog ~ . - 1, data = diabetes)
diabetes_design_std <- scale(diabetes_design, center = TRUE, scale = TRUE)
diabetes_response <- diabetes$prog - mean(diabetes$prog)
diabetes_blasso <- blasso(X = diabetes_design_std, y = diabetes_response, T = 500, thin = 200)
diabetes_blasso
boxplot(diabetes_blasso$beta, horizontal = TRUE, las = 1)
abline(v=0, lty = 1)
hist(rowSums(abs(diabetes_blasso$beta)), probability = TRUE)
diabetes_n <- nrow(diabetes)
bootstrap_idx <- replicate(1000, sample(diabetes_n, size = diabetes_n, replace = TRUE), simplify = FALSE)
library(glmnet)
lambda_cv <- cv.glmnet(x = diabetes_design_std, y = diabetes_response)$lambda.min
diabetes_boot <- sapply(bootstrap_idx, function(idx)
as.matrix(coef(glmnet(x = diabetes_design_std[idx,], y = diabetes_response[idx], lambda = lambda_cv))))
boxplot(t(diabetes_boot[-1,]), horizontal = TRUE, las = 1)
abline(v=0, lty = 1)
install.packages("relaxo")
library(c060)
set.seed (3)
x <- matrix(rnorm (80 * 500 ,0 ,1) ,80 ,500)
y <- x[1:80 ,1:500] %*% c(rep (3 ,2),rep(-3,3),rep (.1 ,495))
res <- stabpath(y,x)
sel <- stabsel(res ,error =0.05 , type="pfer",pi_thr =0.6)
sel
plot(res)
diabetes_stabpath <- stabpath(y = diabetes_response, x = diabetes_design_std)
diabetes_stable_selected <- stabsel(diabetes_stabpath ,error =0.05 , type="pfer",pi_thr =0.6)
diabetes_stable_selected
plot(diabetes_stabpath)
library(relaxo) ## install.packages("relaxo")
diabetes_relaxo <- relaxo(Y=diabetes_response, X = diabetes_design_std)
plot(diabetes_relaxo)
diabetes_relaxo_cv <- cvrelaxo(Y=diabetes_response, X = diabetes_design_std)
print(diabetes_relaxo_cv$phi)
print(diabetes_relaxo_cv$lambda)
fitted_values_relaxo <- predict(diabetes_relaxo_cv)
fitted_values_lasso <- predict(diabetes_cv, newx = diabetes_design_std)[,1]
plot(fitted_values_relaxo,diabetes_response, ylab = "Observed", xlab = "Predicted")
points(fitted_values_lasso,diabetes_response, col = 3)
points(fitted_values_lasso,diabetes_response, col = 3)
legend("topleft", bty = "n", col = c(1,3), c("Relaxed LASSO", "LASSO"), pch = 1)
abline(c(0,1))
var(fitted_values_relaxo-diabetes_response)
var(fitted_values_lasso-diabetes_response)
diabetes_cv <- cv.glmnet(x = diabetes_design_std, y = diabetes_response)
fitted_values_lasso <- predict(diabetes_cv, newx = diabetes_design_std)[,1]
plot(fitted_values_relaxo,diabetes_response, ylab = "Observed", xlab = "Predicted")
points(fitted_values_lasso,diabetes_response, col = 3)
legend("topleft", bty = "n", col = c(1,3), c("Relaxed LASSO", "LASSO"), pch = 1)
abline(c(0,1))
var(fitted_values_relaxo-diabetes_response)
diabetes_relaxo <- relaxo(Y=diabetes_response, X = diabetes_design_std)
plot(diabetes_relaxo)
diabetes_relaxo_cv <- cvrelaxo(Y=diabetes_response, X = diabetes_design_std)
print(diabetes_relaxo_cv$phi)
print(diabetes_relaxo_cv$lambda)
fitted_values_relaxo <- predict(diabetes_relaxo_cv)
fitted_values_lasso <- predict(diabetes_cv, newx = diabetes_design_std)[,1]
plot(fitted_values_relaxo,diabetes_response, ylab = "Observed", xlab = "Predicted")
points(fitted_values_lasso,diabetes_response, col = 3)
legend("topleft", bty = "n", col = c(1,3), c("Relaxed LASSO", "LASSO"), pch = 1)
abline(c(0,1))
var(fitted_values_relaxo-diabetes_response)
var(fitted_values_lasso-diabetes_response)
